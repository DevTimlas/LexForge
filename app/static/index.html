<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexForge - Legal Intelligence Platform</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.0/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- Added for interactive charts -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.5/main.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.5/main.min.js"></script>
    <style>
        :root {
            --primary: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #6366f1 100%);
            --primary-solid: #2563eb;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --surface: #ffffff;
            --background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --border: rgba(226, 232, 240, 0.8);
            --text-primary: #0f172a;
            --text-secondary: #64748b;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 30px rgba(0, 0, 0, 0.12);
            --shadow-xl: 0 20px 50px rgba(0, 0, 0, 0.15);
            --radius: 16px;
            --radius-sm: 8px;
            --glass: rgba(255, 255, 255, 0.9);
            --glass-border: rgba(255, 255, 255, 0.2);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }
        .glass {
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }
        .glass-dark {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .main-container {
            display: flex;
            min-height: 100vh;
            position: relative;
        }
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.6;
            pointer-events: none;
        }
        .bg-animation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(99, 102, 241, 0.15) 0%, transparent 50%);
            animation: float 20s ease-in-out infinite;
        }
        .bg-animation::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 40% 40%, rgba(16, 185, 129, 0.1) 0%, transparent 50%);
            animation: float 15s ease-in-out infinite reverse;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(120deg); }
            66% { transform: translateY(10px) rotate(240deg); }
        }
        .sidebar {
            width: 350px;
            min-height: 100vh;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border);
            padding: 32px;
            position: sticky;
            top: 0;
            overflow-y: auto;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 100;
        }
        .sidebar-header {
            margin-bottom: 40px;
            text-align: center;
        }
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: 700;
            box-shadow: var(--shadow-md);
        }
        .logo-text {
            font-size: 28px;
            font-weight: 800;
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .user-info {
            padding: 20px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: var(--radius);
            border: 1px solid rgba(59, 130, 246, 0.2);
            margin-bottom: 32px;
        }
        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            margin-bottom: 12px;
        }
        .nav-section {
            margin-bottom: 32px;
        }
        .nav-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s ease;
            margin-bottom: 4px;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        .nav-item:hover, .nav-item.active {
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary-solid);
            transform: translateX(4px);
        }
        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: var(--primary);
            border-radius: 0 2px 2px 0;
        }
        .badge {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 12px;
            margin-left: auto;
        }
        .main-content {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
        }
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
            gap: 24px;
        }
        .page-title {
            font-size: 32px;
            font-weight: 800;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .page-subtitle {
            color: var(--text-secondary);
            font-size: 16px;
            margin-top: 4px;
        }
        .card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }
        .card-header {
            padding: 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }
        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .card-body {
            padding: 24px;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 24px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 14px;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        .btn:hover::before {
            left: 100%;
        }
        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            color: white;
        }
        .btn-secondary {
            background: rgba(100, 116, 139, 0.1);
            color: var(--secondary);
            border: 1px solid rgba(100, 116, 139, 0.2);
        }
        .btn-secondary:hover {
            background: rgba(100, 116, 139, 0.2);
            color: var(--secondary);
        }
        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        .btn-sm {
            padding: 8px 16px;
            font-size: 12px;
        }
        .btn-lg {
            padding: 16px 32px;
            font-size: 16px;
        }
        .form-group {
            margin-bottom: 24px;
        }
        .form-label {
            display: block;
            font-weight: 600;
            font-size: 14px;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        .form-control, .form-select {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            background: var(--surface);
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s ease;
        }
        .form-control:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary-solid);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }
        .input-group {
            display: flex;
            gap: 12px;
            align-items: stretch;
        }
        .input-icon {
            position: relative;
        }
        .input-icon input {
            padding-left: 48px;
        }
        .input-icon .icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }
        .feature-card {
            padding: 24px;
            text-align: center;
            border-radius: var(--radius);
            background: var(--glass);
            border: 1px solid var(--border);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        .feature-card:hover::before {
            transform: scaleX(1);
        }
        .feature-icon {
            width: 64px;
            height: 64px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 16px;
            font-size: 28px;
            color: var(--primary-solid);
        }
        .feature-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
        }
        .feature-description {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.6;
        }
        .stat-card {
            padding: 24px;
            border-radius: var(--radius);
            background: var(--glass);
            border: 1px solid var(--border);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .stat-value {
            font-size: 36px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 8px;
            display: block;
        }
        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }
        .stat-trend {
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
        }
        .stat-trend.up {
            color: var(--success);
        }
        .stat-trend.down {
            color: var(--danger);
        }
        .progress {
            height: 8px;
            background: rgba(226, 232, 240, 0.5);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }
        .progress-bar {
            height: 100%;
            background: var(--primary);
            border-radius: 4px;
            transition: width 0.6s ease;
        }
        .search-bar {
            position: relative;
            max-width: 500px;
        }
        .search-input {
            width: 100%;
            padding: 16px 52px 16px 52px;
            background: var(--glass);
            border: 2px solid var(--border);
            border-radius: 50px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        .search-input:focus {
            border-color: var(--primary-solid);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            outline: none;
        }
        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 20px;
        }
        .search-submit {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .search-submit:hover {
            transform: translateY(-50%) scale(1.05);
        }
        .quick-actions {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 32px;
        }
        .quick-action {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 50px;
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s ease;
        }
        .quick-action:hover {
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary-solid);
            transform: translateY(-2px);
        }
        .alert {
            padding: 16px 20px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            border: 1px solid;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.2);
            color: #065f46;
        }
        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: rgba(245, 158, 11, 0.2);
            color: #92400e;
        }
        .alert-danger {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.2);
            color: #991b1b;
        }
        .alert-info {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.2);
            color: #1e40af;
        }
        .fab {
            position: fixed;
            bottom: 32px;
            right: 32px;
            width: 64px;
            height: 64px;
            background: var(--primary);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            box-shadow: var(--shadow-xl);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
        }
        .fab:hover {
            transform: scale(1.1) translateY(-4px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.2);
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 24px;
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow-xl);
        }
        .modal.active {
            display: flex;
        }
        .close-modal {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-secondary);
        }
        #ai-query-modal {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px; /* Changed to right side as per request */
            left: auto;
            width: 400px;
            height: 600px;
            background: transparent;
            z-index: 2000;
        }
        #ai-query-modal.active {
            display: block;
        }
        #ai-query-modal .modal-content {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 0;
            border-radius: var(--radius);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
        }
        .chat-header {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--glass);
        }
        .chat-header h2 {
            font-size: 18px;
            margin: 0;
        }
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background: var(--background);
        }
        .chat-message {
            margin-bottom: 12px;
            display: flex;
            flex-direction: column;
        }
        .chat-message.user {
            align-items: flex-end;
        }
        .chat-message.ai {
            align-items: flex-start;
        }
        .chat-bubble {
            padding: 10px 16px;
            border-radius: 18px;
            max-width: 80%;
            font-size: 14px;
        }
        .chat-message.user .chat-bubble {
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }
        .chat-message.ai .chat-bubble {
            background: var(--glass);
            color: var(--text-primary);
            border-bottom-left-radius: 4px;
        }
        .chat-footer {
            border-top: 1px solid var(--border);
            padding: 8px;
            background: var(--surface);
        }
        .chat-footer form {
            display: flex;
            align-items: center;
        }
        .chat-footer input {
            flex: 1;
            border: none;
            outline: none;
            padding: 8px 12px;
            font-size: 14px;
            background: transparent;
        }
        .chat-footer button {
            border-radius: 50%;
            width: 40px;
            height: 40px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -350px;
                z-index: 1000;
                height: 100vh;
            }
            .sidebar.mobile-open {
                left: 0;
            }
            .main-content {
                width: 100%;
                padding: 16px;
            }
            .content-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            .dashboard-grid,
            .feature-grid {
                grid-template-columns: 1fr;
            }
            .fab {
                bottom: 24px;
                right: 24px;
                width: 56px;
                height: 56px;
                font-size: 20px;
            }
            #ai-query-modal {
                width: 100%;
                height: calc(100vh - 60px);
                bottom: 0;
                right: 0; /* Adjusted for mobile to cover full width from right */
            }
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .text-gradient {
            background: var(--primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .glass-effect {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
        }
        .shadow-glow {
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.3);
        }
        .section {
            display: none;
        }
        #dashboard-section {
            display: block;
        }
        /* New Breadcrumb Styles for Navigation */
        .breadcrumb {
            background: transparent;
            padding: 0;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .breadcrumb-item {
            display: inline-flex;
            align-items: center;
        }
        .breadcrumb-item a {
            color: var(--text-secondary);
            text-decoration: none;
        }
        .breadcrumb-item a:hover {
            color: var(--primary-solid);
        }
        .breadcrumb-separator {
            margin: 0 8px;
            color: var(--text-secondary);
        }
        .breadcrumb-item.active {
            color: var(--text-primary);
            font-weight: 600;
        }
        /* Enhanced Table Styles */
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 8px;
        }
        .data-table th {
            background: rgba(59, 130, 246, 0.1);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border);
            cursor: pointer;
        }
        .data-table td {
            background: var(--glass);
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }
        .data-table tr:hover td {
            background: rgba(59, 130, 246, 0.1);
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }
        .status-setup {
            background: rgba(59, 130, 246, 0.1);
            color: var(--primary-solid);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        /* Chart Containers */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
            margin: 20px 0;
        }
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    <div class="main-container">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">L</div>
                    <div class="logo-text">LexForge</div>
                </div>
                <div class="user-info">
                    <div class="user-avatar">JD</div>
                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">Jane Doe, Esq.</div>
                    <div style="font-size: 12px; color: var(--text-secondary);">Senior Partner â€¢ BigLaw Firm</div>
                </div>
            </div>
            <div class="nav-section">
                <div class="nav-title"><i class="fas fa-home"></i> Core Intelligence</div>
                <a href="#" class="nav-item active" data-section="dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard <span class="badge">3</span></a>
                <a href="#" class="nav-item" data-section="research"><i class="fas fa-search"></i> Legal Research</a>
                <a href="#" class="nav-item" data-section="simulator"><i class="fas fa-balance-scale"></i> Case Simulator</a>
                <a href="#" class="nav-item" data-section="judge"><i class="fas fa-gavel"></i> Judge Analytics</a>
            </div>
            <div class="nav-section">
                <div class="nav-title"><i class="fas fa-file-contract"></i> Document Suite</div>
                <a href="#" class="nav-item" data-section="drafting"><i class="fas fa-file-alt"></i> Smart Drafting</a>
                <a href="#" class="nav-item" data-section="contract"><i class="fas fa-edit"></i> Contract Analysis</a>
                <a href="#" class="nav-item" data-action="upload"><i class="fas fa-upload"></i> Document Upload</a>
                <a href="#" class="nav-item" data-section="citation"><i class="fas fa-clock"></i> Citation Tracker</a>
            </div>
            <div class="nav-section">
                <div class="nav-title"><i class="fas fa-shield-alt"></i> Compliance & Security</div>
                <a href="#" class="nav-item" data-section="privilege"><i class="fas fa-user-shield"></i> Privilege Scanner</a>
                <a href="#" class="nav-item" data-section="evidence"><i class="fas fa-database"></i> Evidence Vault</a>
                <a href="#" class="nav-item" data-section="ethics"><i class="fas fa-chart-line"></i> Ethics Monitor</a>
            </div>
            <div class="nav-section">
                <div class="nav-title"><i class="fas fa-radar"></i> Regulatory Tools</div>
                <a href="#" class="nav-item" data-section="regulatory"><i class="fas fa-binoculars"></i> Regulatory Radar</a>
                <a href="#" class="nav-item" data-section="peer"><i class="fas fa-users"></i> Peer Verification</a>
            </div>
            <div class="nav-section">
                <div class="nav-title"><i class="fas fa-cog"></i> Settings</div>
                <a href="#" class="nav-item" data-section="jurisdictions"><i class="fas fa-globe"></i> Jurisdictions</a>
                <a href="#" class="nav-item" data-section="notifications"><i class="fas fa-bell"></i> Notifications</a>
                <a href="#" class="nav-item" data-section="profile"><i class="fas fa-user-cog"></i> Profile</a>
            </div>
        </nav>
        <div id="overlay" class="overlay"></div>
        <!-- Main Content -->
        <main class="main-content" id="main-content">
            <!-- Breadcrumb Navigation (New) -->
            <nav aria-label="breadcrumb" class="breadcrumb">
                <ol class="breadcrumb-item">
                    <li><a href="#" data-section="dashboard">Dashboard</a></li>
                    <span class="breadcrumb-separator">/</span>
                    <li class="active" id="current-section">Home</li>
                </ol>
            </nav>
            <!-- Case Creation Modal -->
            <div class="modal" id="case-modal">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    <h2 class="page-title">Create New Case</h2>
                    <div class="alert alert-success" id="case-success" style="display: none;"></div>
                    <div class="alert alert-danger" id="case-error" style="display: none;"></div>
                    <form id="case-form">
                        <div class="form-group">
                            <label class="form-label">Case Title</label>
                            <input type="text" class="form-control" id="case-title" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jurisdiction</label>
                            <select class="form-select" id="case-jurisdiction">
                                <option>Federal Courts (US)</option>
                                <option>New York State</option>
                                <option>California State</option>
                                <option>UK High Court</option>
                                <option>EU Court of Justice</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary w-100"><i class="fas fa-plus"></i> Create Case</button>
                    </form>
                </div>
            </div>
            <!-- Document Upload Modal -->
            <div class="modal" id="upload-modal">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    <h2 class="page-title">Upload Documents</h2>
                    <div class="alert alert-success" id="upload-success" style="display: none;"></div>
                    <div class="alert alert-danger" id="upload-error" style="display: none;"></div>
                    <form id="upload-form" enctype="multipart/form-data">
                        <div class="form-group">
                            <label class="form-label">Select Files</label>
                            <input type="file" class="form-control" id="upload-files" accept=".pdf,.doc,.docx" multiple>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Or Paste Document Text</label>
                            <textarea class="form-control" id="upload-form-text" rows="5" placeholder="Paste your document content here..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary w-100"><i class="fas fa-upload"></i> Upload</button>
                    </form>
                </div>
            </div>
            <!-- AI Query Modal (Pop-up Chatbot) -->
            <div class="modal" id="ai-query-modal">
                <div class="modal-content">
                    <div class="chat-header">
                        <h2>LexForge AI Assistant</h2>
                        <span class="close-modal">&times;</span>
                    </div>
                    <div class="chat-messages" id="chat-messages">
                        <!-- Messages will be appended here -->
                    </div>
                    <div class="chat-footer">
                        <form id="ai-query-form">
                            <input type="text" id="ai-query-input" placeholder="Ask me anything about law..." required>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i></button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Alert Details Modal -->
            <div class="modal" id="alert-details-modal">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    <h2 class="page-title" id="alert-title"></h2>
                    <p id="alert-description"></p>
                    <p id="alert-time"></p>
                    <button class="btn btn-primary w-100" id="alert-action-btn">Close</button>
                </div>
            </div>
            <!-- Calendar Modal -->
            <div class="modal" id="calendar-modal">
                <div class="modal-content">
                    <span class="close-modal">&times;</span>
                    <h2 class="page-title">Court Calendar</h2>
                    <div id="calendar"></div>
                </div>
            </div>
            <!-- Header -->
            <div class="content-header">
                <div>
                    <h1 class="page-title"><i class="fas fa-tachometer-alt text-gradient"></i> Dashboard</h1>
                    <p class="page-subtitle">Monitor your legal practice with AI-powered insights and analytics</p>
                </div>
                <div class="search-bar">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" id="search-input" placeholder="Search cases, statutes, or ask a question...">
                    <button class="search-submit"><i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <div id="dashboard-section" class="section">
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <a href="#" class="quick-action" data-action="new-case"><i class="fas fa-plus"></i> New Case</a>
                    <a href="#" class="quick-action" data-action="upload"><i class="fas fa-file-upload"></i> Upload Documents</a>
                    <a href="#" class="quick-action" data-action="ai-assistant"><i class="fas fa-robot"></i> AI Assistant</a>
                    <a href="#" class="quick-action" data-action="calendar"><i class="fas fa-calendar"></i> Court Calendar</a>
                    <a href="#" class="quick-action" data-action="analytics"><i class="fas fa-chart-bar"></i> Analytics</a>
                </div>
                <!-- Alert -->
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>New Feature:</strong> Adversarial Case Simulator is now available with 94% accuracy prediction rates.
                </div>
                <!-- Stats Dashboard -->
                <div class="dashboard-grid" id="stats-grid">
                    <div class="stat-card">
                        <span class="stat-value" id="active-cases">127</span>
                        <div class="stat-label">Active Cases</div>
                        <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +12% this month</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="win-rate">94%</span>
                        <div class="stat-label">Win Rate</div>
                        <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +3% this quarter</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="revenue">$2.4M</span>
                        <div class="stat-label">Revenue Generated</div>
                        <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +18% this year</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="queries-today">156</span>
                        <div class="stat-label">AI Queries Today</div>
                        <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +24% efficiency</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="documents-analyzed">456</span>
                        <div class="stat-label">Documents Analyzed</div>
                        <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +15% this month</div>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="regulatory-alerts">23</span>
                        <div class="stat-label">Regulatory Alerts</div>
                        <div class="stat-trend down"><i class="fas fa-arrow-down"></i> -5% this quarter</div>
                    </div>
                </div>
                <!-- Feature Cards -->
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-brain"></i></div>
                        <h3 class="feature-title">Adversarial Simulator</h3>
                        <p class="feature-description">AI-powered case simulation with 94% prediction accuracy. Test your arguments against opposing counsel strategies.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 94%"></div></div>
                        <small style="color: var(--text-secondary);">94% accuracy rate</small>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-search-plus"></i></div>
                        <h3 class="feature-title">Legal Research Engine</h3>
                        <p class="feature-description">Search across 50M+ legal documents with citation verification and temporal jurisdiction analysis.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 87%"></div></div>
                        <small style="color: var(--text-secondary);">87% relevance score</small>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-gavel"></i></div>
                        <h3 class="feature-title">Judge Analytics</h3>
                        <p class="feature-description">Comprehensive analysis of judge patterns, tendencies, and historical ruling data for strategic advantage.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 91%"></div></div>
                        <small style="color: var(--text-secondary);">91% prediction confidence</small>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-file-contract"></i></div>
                        <h3 class="feature-title">Smart Contract Drafting</h3>
                        <p class="feature-description">AI-assisted contract creation with clause optimization and risk assessment based on industry data.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 89%"></div></div>
                        <small style="color: var(--text-secondary);">89% clause accuracy</small>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
                        <h3 class="feature-title">Privilege Scanner</h3>
                        <p class="feature-description">Automated detection and protection of privileged communications with blockchain-secured audit trails.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 99%"></div></div>
                        <small style="color: var(--text-secondary);">99% detection rate</small>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-clock"></i></div>
                        <h3 class="feature-title">Citation Tracker</h3>
                        <p class="feature-description">Real-time monitoring of case law changes with automated alerts for affected matters.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 96%"></div></div>
                        <small style="color: var(--text-secondary);">96% alert accuracy</small>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-binoculars"></i></div>
                        <h3 class="feature-title">Regulatory Radar</h3>
                        <p class="feature-description">Real-time monitoring of regulatory changes across jurisdictions.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 92%"></div></div>
                        <small style="color: var(--text-secondary);">92% coverage</small>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-users"></i></div>
                        <h3 class="feature-title">Peer Verification</h3>
                        <p class="feature-description">Community-driven verification of legal citations and precedents.</p>
                        <div class="progress" style="margin-top: 16px;"><div class="progress-bar" style="width: 88%"></div></div>
                        <small style="color: var(--text-secondary);">88% agreement rate</small>
                    </div>
                </div>
                <!-- Main Action Cards -->
                <div class="dashboard-grid">
                    <!-- Case Analysis Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-balance-scale"></i> Active Case Analysis</h3>
                            <button class="btn btn-primary btn-sm" data-action="new-analysis"><i class="fas fa-plus"></i> New Analysis</button>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <label class="form-label">Upload Case Documents</label>
                                <div class="input-group">
                                    <input type="file" class="form-control" id="case-files" accept=".pdf,.doc,.docx" multiple>
                                    <button class="btn btn-secondary" data-action="upload-case"><i class="fas fa-upload"></i></button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Jurisdiction</label>
                                <select class="form-select" id="case-jurisdiction-select">
                                    <option>Federal Courts (US)</option>
                                    <option>New York State</option>
                                    <option>California State</option>
                                    <option>UK High Court</option>
                                    <option>EU Court of Justice</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Analysis Type</label>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                                    <button class="btn btn-secondary" data-action="research"><i class="fas fa-search"></i> Research</button>
                                    <button class="btn btn-secondary" data-action="simulate"><i class="fas fa-chess"></i> Simulate</button>
                                </div>
                            </div>
                            <button class="btn btn-primary w-100" data-action="start-analysis"><i class="fas fa-rocket"></i> Start Analysis</button>
                        </div>
                    </div>
                    <!-- AI Assistant Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-robot"></i> LexForge AI Assistant</h3>
                            <div class="badge" style="background: rgba(16, 185, 129, 0.1); color: var(--success);">Online</div>
                        </div>
                        <div class="card-body">
                            <div class="form-group">
                                <div class="input-icon">
                                    <i class="fas fa-comment icon"></i>
                                    <input type="text" class="form-control" id="ai-assistant-input" placeholder="Ask me anything about law..." style="padding-right: 48px;">
                                </div>
                            </div>
                            <div style="background: rgba(59, 130, 246, 0.1); padding: 16px; border-radius: 8px; margin-bottom: 16px; border-left: 4px solid var(--primary-solid);">
                                <strong>Quick Suggestions:</strong>
                                <div style="margin-top: 8px; display: flex; flex-wrap: wrap; gap: 8px;">
                                    <button class="btn btn-sm" style="background: rgba(255, 255, 255, 0.8); border: 1px solid var(--border); font-size: 11px;" data-ai-query="Summary of Smith v. Jones">Summary of Smith v. Jones</button>
                                    <button class="btn btn-sm" style="background: rgba(255, 255, 255, 0.8); border: 1px solid var(--border); font-size: 11px;" data-ai-query="Contract red flags">Contract red flags</button>
                                    <button class="btn btn-sm" style="background: rgba(255, 255, 255, 0.8); border: 1px solid var(--border); font-size: 11px;" data-ai-query="Deadline calculator">Deadline calculator</button>
                                </div>
                            </div>
                            <div class="input-group">
                                <button class="btn btn-success" style="flex: 1;" data-action="voice-query"><i class="fas fa-microphone"></i> Voice Query</button>
                                <button class="btn btn-primary" style="flex: 1;" data-action="ai-assistant"><i class="fas fa-paper-plane"></i> Send</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Recent Activity & Alerts -->
                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-bell"></i> Recent Alerts</h3>
                            <button class="btn btn-secondary btn-sm" data-action="view-all-alerts">View All</button>
                        </div>
                        <div class="card-body" style="padding: 0;" id="alerts-container"></div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-chart-line"></i> Performance Metrics</h3>
                            <select class="form-select" style="width: auto;" id="metrics-period">
                                <option>Last 30 days</option>
                                <option>Last 90 days</option>
                                <option>This year</option>
                            </select>
                        </div>
                        <div class="card-body">
                            <div style="margin-bottom: 24px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">AI Query Accuracy</span>
                                    <span style="font-weight: 700; color: var(--success);" id="query-accuracy">96.4%</span>
                                </div>
                                <div class="progress"><div class="progress-bar" style="width: 96.4%; background: linear-gradient(90deg, var(--success), #34d399);"></div></div>
                            </div>
                            <div style="margin-bottom: 24px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Time Saved Per Case</span>
                                    <span style="font-weight: 700; color: var(--primary-solid);" id="time-saved">14.2 hrs</span>
                                </div>
                                <div class="progress"><div class="progress-bar" style="width: 85%; background: var(--primary);"></div></div>
                            </div>
                            <div style="margin-bottom: 24px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                    <span style="font-weight: 600;">Citation Verification Rate</span>
                                    <span style="font-weight: 700; color: var(--warning);" id="citation-rate">99.1%</span>
                                </div>
                                <div class="progress"><div class="progress-bar" style="width: 99.1%; background: linear-gradient(90deg, var(--warning), #fbbf24);"></div></div>
                            </div>
                            <button class="btn btn-primary w-100" data-action="detailed-analytics"><i class="fas fa-chart-bar"></i> View Detailed Analytics</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="research-section" class="section">
                <h1 class="page-title"><i class="fas fa-search text-gradient"></i> Legal Research</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-search"></i> Legal Research Engine</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Search Query</label>
                            <input type="text" class="form-control" id="research-query" placeholder="Enter your legal research query...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jurisdiction</label>
                            <select class="form-select" id="research-jurisdiction">
                                <option>Federal Courts (US)</option>
                                <option>New York State</option>
                                <option>California State</option>
                                <option>UK High Court</option>
                                <option>EU Court of Justice</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Document Type</label>
                            <select class="form-select" id="research-doc-type">
                                <option>Cases</option>
                                <option>Statutes</option>
                                <option>Regulations</option>
                                <option>Treatises</option>
                                <option>Journals</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Date Range</label>
                            <div class="input-group">
                                <input type="date" class="form-control" id="research-start-date">
                                <input type="date" class="form-control" id="research-end-date">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Complexity Level</label>
                            <select class="form-select" id="research-complexity">
                                <option>Basic</option>
                                <option>Advanced</option>
                                <option>Expert</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="research-submit"><i class="fas fa-search"></i> Search</button>
                        <div id="research-results" style="margin-top: 24px;">
                            <div class="alert alert-info" id="research-results-display" style="display: none;">
                                <strong>Results Found:</strong> <span id="result-count">0</span><br>
                                <div id="result-list"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="simulator-section" class="section">
                <h1 class="page-title"><i class="fas fa-balance-scale text-gradient"></i> Case Simulator</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-balance-scale"></i> Case Simulator</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Case Description</label>
                            <textarea class="form-control" id="simulator-description" rows="4" placeholder="Describe the case..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jurisdiction</label>
                            <select class="form-select" id="simulator-jurisdiction">
                                <option>Federal Courts (US)</option>
                                <option>New York State</option>
                                <option>California State</option>
                                <option>UK High Court</option>
                                <option>EU Court of Justice</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Case Type</label>
                            <select class="form-select" id="simulator-type">
                                <option>Civil Litigation</option>
                                <option>Criminal Defense</option>
                                <option>Contract Dispute</option>
                                <option>Intellectual Property</option>
                                <option>Family Law</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Opponent Aggressiveness</label>
                            <select class="form-select" id="simulator-opponent">
                                <option>Conservative</option>
                                <option>Moderate</option>
                                <option>Aggressive</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Judge Profile</label>
                            <select class="form-select" id="simulator-judge">
                                <option>Strict Interpreter</option>
                                <option>Pragmatic</option>
                                <option>Liberal</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Simulation Depth</label>
                            <select class="form-select" id="simulator-depth">
                                <option>Quick (1 min)</option>
                                <option>Standard (5 min)</option>
                                <option>Deep Analysis (15 min)</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="simulator-submit"><i class="fas fa-chess"></i> Simulate Case</button>
                        <div id="simulator-results" style="margin-top: 24px;">
                            <div class="alert alert-info" id="simulator-results-display" style="display: none;">
                                <strong>Simulation Results:</strong><br>
                                <div id="simulation-content"></div>
                            </div>
                            <div class="chart-container" id="simulation-chart-container" style="display: none;">
                                <canvas id="simulation-outcome-chart"></canvas>
                            </div>
                            <div id="simulation-keypoints" style="display: none;">
                                <h4>Key Points</h4>
                                <ul></ul>
                            </div>
                            <div id="simulation-summary" style="display: none;">
                                <h4>Summary</h4>
                                <p></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="judge-section" class="section">
                <h1 class="page-title"><i class="fas fa-gavel text-gradient"></i> Judge Analytics</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-gavel"></i> Judge Analytics</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Judge Name</label>
                            <input type="text" class="form-control" id="judge-name" placeholder="Enter judge's name...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Court</label>
                            <select class="form-select" id="judge-court">
                                <option>US Supreme Court</option>
                                <option>US District Court</option>
                                <option>State Supreme Court</option>
                                <option>Appellate Court</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jurisdiction</label>
                            <select class="form-select" id="judge-jurisdiction">
                                <option>Federal Courts (US)</option>
                                <option>New York State</option>
                                <option>California State</option>
                                <option>UK High Court</option>
                                <option>EU Court of Justice</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="judge-submit"><i class="fas fa-search"></i> Analyze Judge</button>
                        <div id="judge-results" style="margin-top: 24px;">
                            <div class="alert alert-info" id="judge-profile" style="display: none;">
                                <strong>Judge Profile:</strong><br>
                                <div id="judge-content"></div>
                                <div class="chart-container">
                                    <canvas id="judge-radar-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="drafting-section" class="section">
                <h1 class="page-title"><i class="fas fa-file-alt text-gradient"></i> Smart Drafting Studio</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-file-alt"></i> Smart Drafting Studio</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Document Type</label>
                            <select class="form-select" id="drafting-type">
                                <option>Contract</option>
                                <option>Motion</option>
                                <option>Brief</option>
                                <option>Agreement</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jurisdiction-Specific Law</label>
                            <select class="form-select" id="drafting-jurisdiction">
                                <option>US Federal</option>
                                <option>New York State</option>
                                <option>California State</option>
                                <option>UK Common Law</option>
                                <option>EU Regulations</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tone/Style</label>
                            <select class="form-select" id="drafting-tone">
                                <option>Formal Legal</option>
                                <option>Business Friendly</option>
                                <option>Concise Technical</option>
                                <option>Detailed Explanatory</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Special Clauses</label>
                            <select class="form-select" id="drafting-clauses" multiple>
                                <option>Force Majeure</option>
                                <option>Arbitration</option>
                                <option>Non-Disclosure</option>
                                <option>Indemnity</option>
                                <option>Termination</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Details</label>
                            <textarea class="form-control" id="drafting-details" rows="4" placeholder="Provide details for the draft..."></textarea>
                        </div>
                        <button class="btn btn-primary w-100" id="drafting-submit"><i class="fas fa-file-alt"></i> Generate Draft</button>
                        <div id="drafting-results" style="margin-top: 24px;">
                            <div class="alert alert-info" id="drafting-output" style="display: none;">
                                <strong>Draft Generated:</strong><br>
                                Risk Assessment: Low<br>
                                Clause Optimization: 92%<br>
                                <textarea class="form-control" rows="8" id="draft-text" readonly>Generated document content here...</textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="contract-section" class="section">
                <h1 class="page-title"><i class="fas fa-edit text-gradient"></i> Contract Intelligence</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-edit"></i> Contract Intelligence</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Upload Contract</label>
                            <input type="file" class="form-control" id="contract-file" accept=".pdf,.doc,.docx" multiple>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Or Paste Contract Text</label>
                            <textarea class="form-control" id="contract-text" rows="10" placeholder="Paste contract text here..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Analysis Type</label>
                            <select class="form-select" id="contract-analysis-type">
                                <option>Risk Assessment</option>
                                <option>Clause Analysis</option>
                                <option>Compliance Check</option>
                                <option>Negotiation Points</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="contract-submit"><i class="fas fa-edit"></i> Analyze Contract</button>
                        <div id="contract-results" style="margin-top: 24px;">
                            <div class="alert alert-info" id="contract-output" style="display: none;">
                                <strong>Analysis Complete:</strong><br>
                                Overall Risk Level: Medium<br>
                                Key Red Flags: 3 Identified<br>
                                Market Comparison: 85% Standard<br>
                                <div class="chart-container">
                                    <canvas id="contract-risk-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="citation-section" class="section">
                <h1 class="page-title"><i class="fas fa-clock text-gradient"></i> Citation Intelligence</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-clock"></i> Citation Intelligence</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Citation to Track</label>
                            <input type="text" class="form-control" id="citation-input" placeholder="Enter citation (e.g., 123 U.S. 456)...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Monitoring Frequency</label>
                            <select class="form-select" id="citation-frequency">
                                <option>Real-time</option>
                                <option>Daily</option>
                                <option>Weekly</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="citation-submit"><i class="fas fa-clock"></i> Start Tracking</button>
                        <div id="citation-results" style="margin-top: 24px;">
                            <h4>Active Citation Tracking</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Citation</th>
                                        <th>Status</th>
                                        <th>Last Checked</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="citation-table-body">
                                    <tr>
                                        <td>Smith v. Jones, 123 U.S. 456</td>
                                        <td><span class="status-badge status-active">Good Law</span></td>
                                        <td>2025-09-24</td>
                                        <td><button class="btn btn-sm btn-secondary">View Details</button></td>
                                    </tr>
                                    <tr>
                                        <td>Doe v. Roe, 789 F.2d 101</td>
                                        <td><span class="status-badge status-warning">Distinguished</span></td>
                                        <td>2025-09-23</td>
                                        <td><button class="btn btn-sm btn-secondary">View Details</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div id="privilege-section" class="section">
                <h1 class="page-title"><i class="fas fa-user-shield text-gradient"></i> Privilege Guardian</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-user-shield"></i> Privilege Guardian</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Upload Documents to Scan</label>
                            <input type="file" class="form-control" id="privilege-file" accept=".pdf,.doc,.docx" multiple>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Or Paste Document Text</label>
                            <textarea class="form-control" id="privilege-text" rows="10" placeholder="Paste document text here..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Scan Sensitivity</label>
                            <select class="form-select" id="privilege-sensitivity">
                                <option>Standard</option>
                                <option>High (More Conservative)</option>
                                <option>Low (Aggressive Detection)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Privilege Types</label>
                            <select class="form-select" id="privilege-types" multiple>
                                <option>Attorney-Client</option>
                                <option>Work Product</option>
                                <option>Trade Secrets</option>
                                <option>Medical Records</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="privilege-submit"><i class="fas fa-user-shield"></i> Scan for Privilege</button>
                        <div id="privilege-results" style="margin-top: 24px;">
                            <div class="dashboard-grid">
                                <div class="stat-card">
                                    <span class="stat-value">98%</span>
                                    <div class="stat-label">Detection Rate</div>
                                </div>
                                <div class="stat-card">
                                    <span class="stat-value">12</span>
                                    <div class="stat-label">Privileged Items Found</div>
                                </div>
                            </div>
                            <div class="chart-container">
                                <canvas id="privilege-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="evidence-section" class="section">
                <h1 class="page-title"><i class="fas fa-database text-gradient"></i> Digital Evidence Vault</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-database"></i> Digital Evidence Vault</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Upload Evidence Files</label>
                            <input type="file" class="form-control" id="evidence-file" accept=".pdf,.doc,.docx,.jpg,.png" multiple>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description / Text Evidence</label>
                            <textarea class="form-control" id="evidence-description" rows="5" placeholder="Describe evidence or paste text here..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Evidence Type</label>
                            <select class="form-select" id="evidence-type">
                                <option>Document</option>
                                <option>Image</option>
                                <option>Video</option>
                                <option>Audio</option>
                                <option>Digital Artifact</option>
                                <option>Text</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Associated Case</label>
                            <select class="form-select" id="evidence-case">
                                <option>Smith v. Jones</option>
                                <option>Doe v. Roe</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="evidence-submit"><i class="fas fa-database"></i> Add to Vault</button>
                        <div id="evidence-results" style="margin-top: 24px;">
                            <h4>Evidence Inventory</h4>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>File Name</th>
                                        <th>Type</th>
                                        <th>Upload Date</th>
                                        <th>Chain of Custody</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="evidence-table-body">
                                    <tr data-evidence-id="ev1">
                                        <td>contract.pdf</td>
                                        <td>Document</td>
                                        <td>2025-09-24</td>
                                        <td>Blockchain Verified</td>
                                        <td><span class="status-badge status-active">Secure</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary evidence-summary-btn">Summary</button>
                                        </td>
                                    </tr>
                                    <tr data-evidence-id="ev2">
                                        <td>photo.jpg</td>
                                        <td>Image</td>
                                        <td>2025-09-23</td>
                                        <td>Blockchain Verified</td>
                                        <td><span class="status-badge status-active">Secure</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary evidence-summary-btn">Summary</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div id="evidence-summary-modal" class="modal">
                                <div class="modal-content">
                                    <span class="close-modal">&times;</span>
                                    <h2 class="page-title">Evidence Summary</h2>
                                    <p id="evidence-summary-content"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="ethics-section" class="section">
                <h1 class="page-title"><i class="fas fa-chart-line text-gradient"></i> Ethics Compliance Monitor</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-chart-line"></i> Ethics Compliance Monitor</h3>
                    </div>
                    <div class="card-body">
                        <div class="dashboard-grid">
                            <div class="stat-card">
                                <span class="stat-value">98.5%</span>
                                <div class="stat-label">Overall Compliance Score</div>
                                <div class="stat-trend up"><i class="fas fa-arrow-up"></i> +2.5%</div>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value">0</span>
                                <div class="stat-label">Active Violations</div>
                                <div class="stat-trend down"><i class="fas fa-arrow-down"></i> -1 this month</div>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value">45/50</span>
                                <div class="stat-label">CLE Hours Completed</div>
                                <div class="stat-trend up"><i class="fas fa-arrow-up"></i> On Track</div>
                            </div>
                        </div>
                        <h4>Key Monitoring Areas</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 12px;"><i class="fas fa-check-circle text-success me-2"></i> ABA Model Rules Compliance: 100%</li>
                            <li style="margin-bottom: 12px;"><i class="fas fa-check-circle text-success me-2"></i> Conflict of Interest Detection: No Issues</li>
                            <li style="margin-bottom: 12px;"><i class="fas fa-exclamation-triangle text-warning me-2"></i> Trust Account Monitoring: Review Recommended</li>
                        </ul>
                        <div class="chart-container">
                            <canvas id="ethics-chart"></canvas>
                        </div>
                        <button class="btn btn-primary w-100"><i class="fas fa-sync"></i> Run Full Ethics Scan</button>
                    </div>
                </div>
            </div>
            <div id="jurisdictions-section" class="section">
                <h1 class="page-title"><i class="fas fa-globe text-gradient"></i> Jurisdiction Manager</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-globe"></i> Jurisdiction Manager</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Add New Jurisdiction</label>
                            <select class="form-select" id="new-jurisdiction">
                                <option>Federal Courts (US)</option>
                                <option>New York State</option>
                                <option>California State</option>
                                <option>UK High Court</option>
                                <option>EU Court of Justice</option>
                            </select>
                            <button class="btn btn-primary mt-2 w-100"><i class="fas fa-plus"></i> Add Jurisdiction</button>
                        </div>
                        <h4>Active Jurisdictions</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Jurisdiction</th>
                                    <th>Bar Admission</th>
                                    <th>Court Rules</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Federal Courts (US)</td>
                                    <td>Active since 2015</td>
                                    <td>FRCP Compliant</td>
                                    <td><span class="status-badge status-active">Active</span></td>
                                    <td><button class="btn btn-sm btn-secondary">Edit</button></td>
                                </tr>
                                <tr>
                                    <td>New York State</td>
                                    <td>Pending Renewal</td>
                                    <td>CPLR Updated</td>
                                    <td><span class="status-badge status-pending">Pending</span></td>
                                    <td><button class="btn btn-sm btn-secondary">Edit</button></td>
                                </tr>
                                <tr>
                                    <td>California State</td>
                                    <td>Not Admitted</td>
                                    <td>CCP Rules</td>
                                    <td><span class="status-badge status-setup">Setup Required</span></td>
                                    <td><button class="btn btn-sm btn-secondary">Setup</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div id="notifications-section" class="section">
                <h1 class="page-title"><i class="fas fa-bell text-gradient"></i> Notification Center</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-bell"></i> Notification Center</h3>
                    </div>
                    <div class="card-body">
                        <h4>Notification Preferences</h4>
                        <div class="form-group">
                            <label class="form-label">Email Notifications</label>
                            <select class="form-select">
                                <option>All Alerts</option>
                                <option>Critical Only</option>
                                <option>None</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">SMS Alerts</label>
                            <select class="form-select">
                                <option>Deadlines Only</option>
                                <option>All Critical</option>
                                <option>None</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Slack Integration</label>
                            <input type="text" class="form-control" placeholder="Enter Slack Webhook URL">
                        </div>
                        <h4>Upcoming Deadlines</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 12px;"><i class="fas fa-calendar-day text-warning me-2"></i> Motion Filing: 3 days</li>
                            <li style="margin-bottom: 12px;"><i class="fas fa-calendar-day text-danger me-2"></i> Court Hearing: Tomorrow</li>
                            <li style="margin-bottom: 12px;"><i class="fas fa-calendar-day text-success me-2"></i> CLE Deadline: 45 days</li>
                        </ul>
                        <button class="btn btn-primary w-100"><i class="fas fa-save"></i> Save Preferences</button>
                    </div>
                </div>
            </div>
            <div id="profile-section" class="section">
                <h1 class="page-title"><i class="fas fa-user-cog text-gradient"></i> Professional Profile Settings</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-user-cog"></i> Professional Profile Settings</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Profile Photo</label>
                            <input type="file" class="form-control" accept="image/*">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-control" value="Jane Doe, Esq.">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Firm/Organization</label>
                            <input type="text" class="form-control" value="BigLaw Firm">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Practice Areas</label>
                            <select class="form-select" multiple>
                                <option selected>Litigation</option>
                                <option selected>Corporate Law</option>
                                <option>IP Law</option>
                                <option>Family Law</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Security: Enable 2FA</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="2fa-switch" checked>
                            </div>
                        </div>
                        <h4>Usage Statistics</h4>
                        <div class="dashboard-grid">
                            <div class="stat-card">
                                <span class="stat-value">456</span>
                                <div class="stat-label">Queries This Month</div>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value">28</span>
                                <div class="stat-label">Documents Analyzed</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">API Key for Integrations</label>
                            <input type="text" class="form-control" value="sk-lexforge-abc123xyz" readonly>
                            <button class="btn btn-secondary mt-2"><i class="fas fa-sync"></i> Regenerate Key</button>
                        </div>
                        <button class="btn btn-primary w-100"><i class="fas fa-save"></i> Save Profile</button>
                    </div>
                </div>
            </div>
            <!-- New Analytics Section -->
            <div id="analytics-section" class="section">
                <h1 class="page-title"><i class="fas fa-chart-bar text-gradient"></i> Analytics</h1>
                <p class="page-subtitle">Detailed performance metrics and insights</p>
                <div class="dashboard-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-chart-pie"></i> Usage Overview</h3>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="usage-chart"></canvas>
                            </div>
                            <button class="btn btn-primary w-100" id="refresh-usage"><i class="fas fa-sync"></i> Refresh Data</button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-feedback"></i> Feedback Summary</h3>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="feedback-chart"></canvas>
                            </div>
                            <button class="btn btn-primary w-100" id="submit-feedback"><i class="fas fa-comment"></i> Submit Feedback</button>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fas fa-trophy"></i> Performance Benchmarks</h3>
                        </div>
                        <div class="card-body">
                            <ul>
                                <li>Win Rate: 94% (Industry Avg: 85%)</li>
                                <li>Time Saved: 14.2 hrs/case (Industry Avg: 8 hrs)</li>
                                <li>Query Accuracy: 96.4% (Industry Avg: 90%)</li>
                            </ul>
                            <button class="btn btn-primary w-100" id="export-report"><i class="fas fa-download"></i> Export Report</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="regulatory-section" class="section">
                <h1 class="page-title"><i class="fas fa-binoculars text-gradient"></i> Regulatory Radar</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-binoculars"></i> Regulatory Monitoring</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Jurisdiction</label>
                            <select class="form-select" id="regulatory-jurisdiction">
                                <option>US Federal</option>
                                <option>EU</option>
                                <option>UK</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Practice Area</label>
                            <select class="form-select" id="regulatory-area">
                                <option>Corporate</option>
                                <option>IP</option>
                                <option>Environmental</option>
                            </select>
                        </div>
                        <button class="btn btn-primary w-100" id="regulatory-submit"><i class="fas fa-search"></i> Monitor Changes</button>
                        <div id="regulatory-results" style="margin-top: 24px;"></div>
                    </div>
                </div>
            </div>
            <div id="peer-section" class="section">
                <h1 class="page-title"><i class="fas fa-users text-gradient"></i> Peer Verification</h1>
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title"><i class="fas fa-users"></i> Citation Verification</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">Citation</label>
                            <input type="text" class="form-control" id="peer-citation" placeholder="Enter citation...">
                        </div>
                        <button class="btn btn-primary w-100" id="peer-submit"><i class="fas fa-check"></i> Verify</button>
                        <div id="peer-results" style="margin-top: 24px;"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <!-- Floating Action Button -->
    <button class="fab" title="Quick Actions" id="fab"><i class="fas fa-plus"></i></button>
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_BASE_URL = 'http://localhost:8000';
        // Fetch metrics
        async function fetchMetrics() {
            try {
                const period = document.getElementById('metrics-period').value.toLowerCase().replace(/ /g, '_');
                const response = await axios.get(`${API_BASE_URL}/api/v1/metrics?period=${period}`);
                document.getElementById('active-cases').textContent = response.data.activeCases;
                document.getElementById('win-rate').textContent = `${response.data.winRate}%`;
                document.getElementById('revenue').textContent = `$${(response.data.revenue / 1000000).toFixed(1)}M`;
                document.getElementById('queries-today').textContent = response.data.queriesToday;
                document.getElementById('query-accuracy').textContent = `${response.data.queryAccuracy}%`;
                document.getElementById('time-saved').textContent = `${response.data.timeSaved} hrs`;
                document.getElementById('citation-rate').textContent = `${response.data.citationRate}%`;
                document.getElementById("documents-analyzed").textContent = response.data.documentsAnalyzed || 456;
                document.getElementById("regulatory-alerts").textContent = response.data.regulatoryAlerts || 23;
            } catch (error) {
                console.error('Error fetching metrics:', error);
                showNotification('Failed to fetch metrics: ' + (error.response?.data?.detail || error.message));
            }
        }
        // Fetch alerts
        async function fetchAlerts() {
            try {
                const response = await axios.get(`${API_BASE_URL}/api/v1/alerts`);
                const container = document.getElementById('alerts-container');
                container.innerHTML = '';
                response.data.forEach((alert, index) => {
                    const div = document.createElement('div');
                    div.style = 'padding: 20px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 16px;';
                    div.innerHTML = `
                        <div style="width: 40px; height: 40px; background: rgba(${alert.type === 'danger' ? '239, 68, 68' : alert.type === 'warning' ? '245, 158, 11' : '16, 185, 129'}, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--${alert.type});">
                            <i class="fas fa-${alert.type === 'danger' ? 'exclamation-triangle' : alert.type === 'warning' ? 'calendar-alt' : 'check-circle'}"></i>
                        </div>
                        <div style="flex: 1;">
                            <div class="alert-title" style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">${alert.title}</div>
                            <div class="alert-description" style="font-size: 14px; color: var(--text-secondary);">${alert.description}</div>
                            <div class="alert-time" style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">${alert.time}</div>
                        </div>
                        <button class="btn btn-${alert.type} btn-sm" data-alert-action="${alert.action}">${alert.action}</button>
                    `;
                    container.appendChild(div);
                });
                // Add event listeners to alert buttons
                document.querySelectorAll('#alerts-container button').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const action = btn.dataset.alertAction;
                        const alertDiv = btn.closest('div');
                        const title = alertDiv.querySelector('.alert-title').textContent;
                        const description = alertDiv.querySelector('.alert-description').textContent;
                        const time = alertDiv.querySelector('.alert-time').textContent;
                        if (action === 'View' || action === 'Review') {
                            document.getElementById('alert-title').textContent = title;
                            document.getElementById('alert-description').textContent = description;
                            document.getElementById('alert-time').textContent = time;
                            document.getElementById('alert-action-btn').textContent = 'Close';
                            document.getElementById('alert-action-btn').addEventListener('click', () => {
                                document.getElementById('alert-details-modal').classList.remove('active');
                                alertDiv.remove();
                            }, { once: true });
                            document.getElementById('alert-details-modal').classList.add('active');
                        } else if (action === 'Schedule') {
                            // Simulate scheduling
                            showNotification('Scheduled successfully');
                            alertDiv.remove();
                        } else {
                            alertDiv.remove();
                            showNotification(`${action} completed successfully`);
                        }
                    });
                });
            } catch (error) {
                console.error('Error fetching alerts:', error);
                showNotification('Failed to fetch alerts: ' + (error.response?.data?.detail || error.message));
            }
        }
        // Case creation handler
        document.getElementById('case-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const submitBtn = this.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            const title = document.getElementById('case-title').value;
            const jurisdiction = document.getElementById('case-jurisdiction').value;
            const successDiv = document.getElementById('case-success');
            const errorDiv = document.getElementById('case-error');
            try {
                const response = await axios.post(`${API_BASE_URL}/api/v1/cases/create`, { title, jurisdiction });
                successDiv.innerHTML = marked.parse(`Case created: ${response.data.case_id}`); // Render as Markdown
                successDiv.style.display = 'block';
                errorDiv.style.display = 'none';
                setTimeout(() => document.getElementById('case-modal').classList.remove('active'), 2000);
                fetchMetrics();
            } catch (error) {
                console.error('Case creation error:', error);
                errorDiv.innerHTML = error.response?.data?.detail || 'Case creation failed: ' + error.message;
                errorDiv.style.display = 'block';
                successDiv.style.display = 'none';
            } finally {
                submitBtn.disabled = false;
            }
        });
        // Document upload handler (support file or text)
        document.getElementById('upload-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const submitBtn = this.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            const files = document.getElementById('upload-files').files;
            const text = document.getElementById('upload-form-text').value.trim();
            const successDiv = document.getElementById('upload-success');
            const errorDiv = document.getElementById('upload-error');
            const formData = new FormData();
            let hasContent = false;
            for (let file of files) {
                formData.append('files', file);
                hasContent = true;
            }
            formData.append('text', text); // Append text always
            if (text) hasContent = true;
            if (!hasContent) {
                errorDiv.innerHTML = 'Please upload files or paste text';
                errorDiv.style.display = 'block';
                successDiv.style.display = 'none';
                submitBtn.disabled = false;
                return;
            }
            try {
                const response = await axios.post(`${API_BASE_URL}/api/v1/cases/upload`, formData, {
                    headers: { 'Content-Type': 'multipart/form-data' }
                });
                successDiv.innerHTML = `Uploaded: ${response.data.message || 'Success'}`;
                successDiv.style.display = 'block';
                errorDiv.style.display = 'none';
                setTimeout(() => document.getElementById('upload-modal').classList.remove('active'), 2000);
            } catch (error) {
                console.error('Upload error:', error);
                errorDiv.innerHTML = error.response?.data?.detail || 'Upload failed: ' + error.message;
                errorDiv.style.display = 'block';
                successDiv.style.display = 'none';
            } finally {
                submitBtn.disabled = false;
            }
        });
        // AI query handler for chatbot
        document.getElementById('ai-query-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const queryInput = document.getElementById('ai-query-input');
            const submitBtn = this.querySelector('button[type="submit"]');
            const query = queryInput.value.trim();
            if (!query) return;
            submitBtn.disabled = true;
            queryInput.disabled = true;
            const chatMessages = document.getElementById('chat-messages');
            // Append user message
            const userMsg = document.createElement('div');
            userMsg.className = 'chat-message user';
            userMsg.innerHTML = `<div class="chat-bubble">${query}</div>`;
            chatMessages.appendChild(userMsg);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            queryInput.value = '';
            try {
                const response = await axios.post(`${API_BASE_URL}/api/v1/ai/ai-query`, { prompt: query });
                // Append AI message with Markdown rendering
                const aiMsg = document.createElement('div');
                aiMsg.className = 'chat-message ai';
                let parsedResponse;
                try {
                    parsedResponse = marked.parse(response.data.result);
                } catch (parseError) {
                    console.error('Markdown parse error:', parseError);
                    parsedResponse = '<div class="alert alert-warning">Response received but formatting failed: ' + response.data.result + '</div>';
                }
                aiMsg.innerHTML = `<div class="chat-bubble">${parsedResponse}</div>`;
                chatMessages.appendChild(aiMsg);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                fetchMetrics();
            } catch (error) {
                console.error('AI query error:', error);
                const errorMsg = document.createElement('div');
                errorMsg.className = 'chat-message ai';
                errorMsg.innerHTML = `<div class="chat-bubble" style="background: rgba(239, 68, 68, 0.1); color: var(--danger);">Error: ${error.response?.data?.detail || error.message}</div>`;
                chatMessages.appendChild(errorMsg);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            } finally {
                submitBtn.disabled = false;
                queryInput.disabled = false;
                queryInput.focus();
            }
        });
        // AI assistant card handler
        document.querySelectorAll('[data-action="ai-assistant"]').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const assistantInput = document.getElementById('ai-assistant-input');
                const query = assistantInput.value.trim();
                const modal = document.getElementById('ai-query-modal');
                const chatMessages = document.getElementById('chat-messages');
                modal.classList.add('active');
                if (chatMessages.innerHTML.trim() === '') {
                    const welcomeMsg = document.createElement('div');
                    welcomeMsg.className = 'chat-message ai';
                    welcomeMsg.innerHTML = `<div class="chat-bubble">${marked.parse('Hello! How can I assist you with legal matters today?')}</div>`;
                    chatMessages.appendChild(welcomeMsg);
                }
                if (query) {
                    document.getElementById('ai-query-input').value = query;
                    document.getElementById('ai-query-form').dispatchEvent(new Event('submit'));
                    assistantInput.value = '';
                }
            });
        });
        // Quick action handlers
        document.querySelectorAll('.quick-action').forEach(action => {
            action.addEventListener('click', function(e) {
                e.preventDefault();
                const actionType = this.dataset.action;
                if (actionType === 'new-case') {
                    document.getElementById('case-modal').classList.add('active');
                } else if (actionType === 'upload') {
                    document.getElementById('upload-modal').classList.add('active');
                } else if (actionType === 'ai-assistant') {
                    document.getElementById('ai-query-modal').classList.add('active');
                } else if (actionType === 'analytics') {
                    // Updated to open analytics section directly
                    document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
                    document.getElementById('analytics-section').style.display = 'block';
                    document.querySelector('.page-title').innerHTML = '<i class="fas fa-chart-bar text-gradient"></i> Analytics';
                    document.querySelector('.page-subtitle').textContent = 'Detailed performance metrics and insights';
                    fetchDetailedAnalytics(); // New function to fetch detailed data
                } else {
                    showNotification(`Opening ${this.textContent.trim()}...`);
                }
            });
        });
        // Sidebar navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                const action = this.dataset.action;
                const section = this.dataset.section;
                if (action) {
                    if (action === 'upload') {
                        document.getElementById('upload-modal').classList.add('active');
                    }
                } else if (section) {
                    document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
                    const targetSection = document.getElementById(`${section}-section`);
                    if (targetSection) {
                        targetSection.style.display = 'block';
                    }
                    const icon = this.querySelector('i').outerHTML;
                    const title = this.childNodes[1].nodeValue.trim();
                    document.querySelector('.page-title').innerHTML = `${icon.replace('fas', 'fas text-gradient')} ${title}`;
                    document.querySelector('.page-subtitle').textContent = `Overview of your ${title.toLowerCase()}`;
                    document.getElementById('current-section').textContent = title;
                    history.pushState({ section }, '', `#${section}`);
                    if (section === 'dashboard') {
                        fetchMetrics();
                        fetchAlerts();
                    } else if (section === 'analytics') { // Added support if added to sidebar later
                        fetchDetailedAnalytics();
                    } else if (section === 'judge') {
                        initJudgeRadarChart();
                    } else if (section === 'contract') {
                        initContractRiskChart();
                    } else if (section === 'privilege') {
                        initPrivilegeChart();
                    } else if (section === 'ethics') {
                        initEthicsChart();
                    } else if (section === 'analytics') {
                        initUsageChart();
                        initFeedbackChart();
                    } else if (section === 'evidence') {
                        fetchEvidenceInventory();
                    } else if (section === 'simulation') {
                        fetchSimulationData();
                    }
                }
            });
        });
        // Handle browser back/forward
        window.addEventListener('popstate', (event) => {
            if (event.state && event.state.section) {
                document.querySelector(`[data-section="${event.state.section}"]`).click();
            } else {
                document.querySelector('[data-section="dashboard"]').click();
            }
        });
        // FAB handler
        document.getElementById('fab').addEventListener('click', function() {
            const actions = ['New Case', 'Upload Documents', 'AI Query', 'Generate Report', 'Schedule Meeting'];
            const modalMap = {
                'New Case': 'case-modal',
                'Upload Documents': 'upload-modal',
                'AI Query': 'ai-query-modal'
            };
            const action = actions[Math.floor(Math.random() * actions.length)];
            if (modalMap[action]) {
                document.getElementById(modalMap[action]).classList.add('active');
            } else {
                showNotification(`Quick Action: ${action}`);
            }
        });
        // Search handler for enter key
        document.querySelector('.search-input').addEventListener('keypress', async function(e) {
            if (e.key === 'Enter') {
                const query = this.value.trim();
                if (query) {
                    this.value = 'Searching...';
                    this.disabled = true;
                    try {
                        const response = await axios.post(`${API_BASE_URL}/api/v1/ai/ai-query`, { prompt: query });
                        this.value = '';
                        this.disabled = false;
                        this.placeholder = `Results for: "${query}"`;
                        showNotification(`Search results: ${response.data.result}`);
                        fetchMetrics();
                    } catch (error) {
                        this.value = '';
                        this.disabled = false;
                        showNotification('Search failed: ' + (error.response?.data?.detail || error.message));
                    }
                }
            }
        });
        // Search submit button handler
        document.querySelector('.search-submit').addEventListener('click', function() {
            const input = document.getElementById('search-input');
            const event = new KeyboardEvent('keypress', { key: 'Enter' });
            input.dispatchEvent(event);
        });
        // Mobile sidebar toggle
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            sidebar.classList.toggle('mobile-open');
            if (sidebar.classList.contains('mobile-open')) {
                overlay.style.display = 'block';
            } else {
                overlay.style.display = 'none';
            }
        }
        if (window.innerWidth <= 768) {
            const header = document.querySelector('.content-header');
            const menuBtn = document.createElement('button');
            menuBtn.innerHTML = '<i class="fas fa-bars"></i>';
            menuBtn.className = 'btn btn-secondary';
            menuBtn.onclick = toggleSidebar;
            header.insertBefore(menuBtn, header.firstChild);
        }
        // Notification helper
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'alert alert-info';
            notification.innerHTML = `<i class="fas fa-info-circle me-2"></i>${message}`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '1000';
            notification.style.minWidth = '300px';
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 5000); // Increased duration for better visibility
        }
        // Progress bar animation
        function animateProgressBars() {
            document.querySelectorAll('.progress-bar').forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => bar.style.width = width, 500);
            });
        }
        // New function to fetch detailed analytics (placeholder for real data fetch)
        async function fetchDetailedAnalytics() {
            try {
                // Placeholder: Fetch from /api/v1/analytics/usage or similar
                const response = await axios.get(`${API_BASE_URL}/api/v1/analytics/usage`);
                // Update charts or data in analytics-section
                document.getElementById('usage-chart').innerHTML = `[Updated Chart: ${response.data.message || 'Usage Data Loaded'}]`;
                // Add more updates as needed
            } catch (error) {
                showNotification('Failed to load detailed analytics: ' + (error.response?.data?.detail || error.message));
            }
        }
        // Fetch evidence inventory
        async function fetchEvidenceInventory() {
            try {
                const response = await axios.get(`${API_BASE_URL}/api/v1/evidence-vault/inventory`);
                const tableBody = document.getElementById('evidence-table-body');
                tableBody.innerHTML = '';
                response.data.forEach(evidence => {
                    const tr = document.createElement('tr');
                    tr.dataset.evidenceId = evidence.id;
                    tr.innerHTML = `
                        <td>${evidence.filename || 'Text Evidence'}</td>
                        <td>${evidence.evidence_type}</td>
                        <td>${evidence.upload_date}</td>
                        <td>${evidence.chain_of_custody}</td>
                        <td><span class="status-badge status-active">${evidence.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-secondary evidence-summary-btn">Summary</button>
                        </td>
                    `;
                    tableBody.appendChild(tr);
                });
                // Add summary button listeners
                document.querySelectorAll('.evidence-summary-btn').forEach(btn => {
                    btn.addEventListener('click', async () => {
                        const evidenceId = btn.closest('tr').dataset.evidenceId;
                        try {
                            const response = await axios.get(`${API_BASE_URL}/api/v1/evidence-vault/summary/${evidenceId}`);
                            document.getElementById('evidence-summary-content').innerHTML = response.data.summary;
                            document.getElementById('evidence-summary-modal').classList.add('active');
                        } catch (error) {
                            showNotification('Failed to load summary');
                        }
                    });
                });
            } catch (error) {
                showNotification('Failed to load evidence inventory');
            }
        }
        // Fetch simulation data (for extended simulation)
        async function fetchSimulationData() {
            // Placeholder for fetching previous simulations or data
            try {
                const response = await axios.get(`${API_BASE_URL}/api/v1/simulation/data`);
                // Update UI with data if needed
            } catch (error) {
                showNotification('Failed to load simulation data');
            }
        }
        // Extended simulation submit with charts etc.
        const simulatorSubmit = document.getElementById('simulator-submit');
        if (simulatorSubmit) {
            simulatorSubmit.addEventListener('click', async () => {
                simulatorSubmit.disabled = true;
                const description = document.getElementById('simulator-description').value.trim();
                const jurisdiction = document.getElementById('simulator-jurisdiction').value;
                if (description) {
                    try {
                        const response = await axios.post(`${API_BASE_URL}/api/v1/simulation/simulate-case`, { description, jurisdiction });
                        const resultsDisplay = document.getElementById('simulator-results-display');
                        resultsDisplay.innerHTML = marked.parse(response.data.simulation_result.data.details);
                        resultsDisplay.style.display = 'block';
                        // Display keypoints
                        const keypointsUl = document.getElementById('simulation-keypoints').querySelector('ul');
                        keypointsUl.innerHTML = '';
                        response.data.simulation_result.data.keypoints.forEach(point => {
                            const li = document.createElement('li');
                            li.textContent = point;
                            keypointsUl.appendChild(li);
                        });
                        document.getElementById('simulation-keypoints').style.display = 'block';
                        // Display summary
                        document.getElementById('simulation-summary').querySelector('p').textContent = response.data.simulation_result.data.summary;
                        document.getElementById('simulation-summary').style.display = 'block';
                        // Init chart
                        document.getElementById('simulation-chart-container').style.display = 'block';
                        initSimulationOutcomeChart([response.data.simulation_result.data.probability * 100, 100 - response.data.simulation_result.data.probability * 100]);
                    } catch (error) {
                        console.error('Simulation error:', error);
                        document.getElementById('simulator-results').innerHTML = `<div class="alert alert-danger">Simulation failed: ${error.response?.data?.detail || error.message}</div>`;
                    } finally {
                        simulatorSubmit.disabled = false;
                    }
                } else {
                    simulatorSubmit.disabled = false;
                }
            });
        }
        function initSimulationOutcomeChart(data) {
            const ctx = document.getElementById('simulation-outcome-chart')?.getContext('2d');
            if (ctx) {
                new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: ['Win Probability', 'Loss Probability'],
                        datasets: [{
                            data: data,
                            backgroundColor: ['#10b981', '#ef4444']
                        }]
                    },
                    options: {
                        responsive: true
                    }
                });
            }
        }
        // Initialize
        window.addEventListener('load', () => {
            try {
                setTimeout(animateProgressBars, 1000);
                fetchMetrics();
                fetchAlerts();
                setInterval(fetchMetrics, 30000);
                setInterval(fetchAlerts, 30000);
                document.querySelectorAll('.close-modal').forEach(button => {
                    button.addEventListener('click', function() {
                        this.closest('.modal').classList.remove('active');
                    });
                });
                // Metrics period change handler
                const metricsPeriod = document.getElementById('metrics-period');
                if (metricsPeriod) {
                    metricsPeriod.addEventListener('change', fetchMetrics);
                }
                // Quick suggestions in AI assistant
                document.querySelectorAll('[data-ai-query]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.getElementById('ai-assistant-input').value = btn.dataset.aiQuery;
                        document.querySelector('[data-action="ai-assistant"]').click();
                    });
                });
                // Case analysis buttons
                document.querySelectorAll('[data-action="research"], [data-action="simulate"]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        document.querySelectorAll('[data-action="research"], [data-action="simulate"]').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        window.analysisType = btn.dataset.action;
                    });
                });
                const uploadCase = document.querySelector('[data-action="upload-case"]');
                if (uploadCase) {
                    uploadCase.addEventListener('click', async (e) => {
                        e.preventDefault();
                        uploadCase.disabled = true;
                        const files = document.getElementById('case-files').files;
                        if (files.length === 0) {
                            showNotification('No files selected');
                            uploadCase.disabled = false;
                            return;
                        }
                        const formData = new FormData();
                        for (let file of files) {
                            formData.append('files', file);
                        }
                        try {
                            const response = await axios.post(`${API_BASE_URL}/api/v1/cases/upload`, formData, {
                                headers: { 'Content-Type': 'multipart/form-data' }
                            });
                            showNotification(`Uploaded: ${response.data.message || 'Success'}`);
                        } catch (error) {
                            showNotification('Upload failed: ' + (error.response?.data?.detail || error.message));
                        } finally {
                            uploadCase.disabled = false;
                        }
                    });
                }
                const startAnalysis = document.querySelector('[data-action="start-analysis"]');
                if (startAnalysis) {
                    startAnalysis.addEventListener('click', async (e) => {
                        e.preventDefault();
                        startAnalysis.disabled = true;
                        const jurisdiction = document.getElementById('case-jurisdiction-select').value;
                        const type = window.analysisType || 'research';
                        try {
                            const response = await axios.post(`${API_BASE_URL}/api/v1/analysis`, { jurisdiction, type });
                            showNotification(`Analysis started: ${response.data.result}`);
                        } catch (error) {
                            showNotification('Analysis failed: ' + (error.response?.data?.detail || error.message));
                        } finally {
                            startAnalysis.disabled = false;
                        }
                    });
                }
                const newAnalysis = document.querySelector('[data-action="new-analysis"]');
                if (newAnalysis) {
                    newAnalysis.addEventListener('click', (e) => {
                        e.preventDefault();
                        showNotification('Starting new analysis...');
                        // Reset forms if needed
                        document.getElementById('case-files').value = '';
                        document.getElementById('case-jurisdiction-select').value = 'Federal Courts (US)';
                        document.querySelectorAll('[data-action="research"], [data-action="simulate"]').forEach(b => b.classList.remove('active'));
                        window.analysisType = null;
                    });
                }
                // View all alerts
                const viewAllAlerts = document.querySelector('[data-action="view-all-alerts"]');
                if (viewAllAlerts) {
                    viewAllAlerts.addEventListener('click', (e) => {
                        e.preventDefault();
                        showNotification('Viewing all alerts...');
                        // Future: Open modal with all alerts or fetch with all=true
                    });
                }
                // Detailed analytics from dashboard card
                const detailedAnalytics = document.querySelector('[data-action="detailed-analytics"]');
                if (detailedAnalytics) {
                    detailedAnalytics.addEventListener('click', (e) => {
                        e.preventDefault();
                        document.querySelectorAll('.quick-action[data-action="analytics"]').forEach(a => a.click());
                    });
                }
                // Legal research submit
                const researchSubmit = document.getElementById('research-submit');
                if (researchSubmit) {
                    researchSubmit.addEventListener('click', async () => {
                        researchSubmit.disabled = true;
                        const query = document.getElementById('research-query').value.trim();
                        const jurisdiction = document.getElementById('research-jurisdiction').value;
                        if (query) {
                            try {
                                const response = await axios.post(`${API_BASE_URL}/api/v1/ai/ai-query`, { prompt: `Legal research on "${query}" in jurisdiction ${jurisdiction}` });
                                const resultsDisplay = document.getElementById('research-results-display');
                                let parsedResponse;
                                try {
                                    parsedResponse = marked.parse(response.data.result);
                                } catch (parseError) {
                                    console.error('Markdown parse error:', parseError);
                                    parsedResponse = '<div class="alert alert-warning">Response received but formatting failed: ' + response.data.result + '</div>';
                                }
                                resultsDisplay.innerHTML = parsedResponse;
                                resultsDisplay.style.display = 'block';
                            } catch (error) {
                                console.error('Research error:', error);
                                document.getElementById('research-results').innerHTML = `<div class="alert alert-danger">Research failed: ${error.response?.data?.detail || error.message}</div>`;
                            } finally {
                                researchSubmit.disabled = false;
                            }
                        } else {
                            researchSubmit.disabled = false;
                        }
                    });
                }
                // Case simulator submit
                const simulatorSubmit = document.getElementById('simulator-submit');
                if (simulatorSubmit) {
                    simulatorSubmit.addEventListener('click', async () => {
                        simulatorSubmit.disabled = true;
                        const description = document.getElementById('simulator-description').value.trim();
                        const jurisdiction = document.getElementById('simulator-jurisdiction').value;
                        if (description) {
                            try {
                                const response = await axios.post(`${API_BASE_URL}/api/v1/simulation/simulate-case`, { description, jurisdiction });
                                const resultsDisplay = document.getElementById('simulator-results-display');
                                let parsedResponse;
                                try {
                                    parsedResponse = marked.parse(response.data.result);
                                } catch (parseError) {
                                    console.error('Markdown parse error:', parseError);
                                    parsedResponse = '<div class="alert alert-warning">Simulation complete but formatting failed: ' + response.data.result + '</div>';
                                }
                                resultsDisplay.innerHTML = parsedResponse;
                                resultsDisplay.style.display = 'block';
                            } catch (error) {
                                console.error('Simulation error:', error);
                                document.getElementById('simulator-results').innerHTML = `<div class="alert alert-danger">Simulation failed: ${error.response?.data?.detail || error.message}</div>`;
                            } finally {
                                simulatorSubmit.disabled = false;
                            }
                        } else {
                            simulatorSubmit.disabled = false;
                        }
                    });
                }
                // Judge analytics submit
                const judgeSubmit = document.getElementById('judge-submit');
                if (judgeSubmit) {
                    judgeSubmit.addEventListener('click', async () => {
                        judgeSubmit.disabled = true;
                        const name = document.getElementById('judge-name').value.trim();
                        const jurisdiction = document.getElementById('judge-jurisdiction').value;
                        if (name) {
                            try {
                                const response = await axios.post(`${API_BASE_URL}/api/v1/ai/ai-query`, { prompt: `Analyze judge ${name} in jurisdiction ${jurisdiction}` });
                                const profileDisplay = document.getElementById('judge-profile');
                                let parsedResponse;
                                try {
                                    parsedResponse = marked.parse(response.data.result);
                                } catch (parseError) {
                                    console.error('Markdown parse error:', parseError);
                                    parsedResponse = '<div class="alert alert-warning">Analysis complete but formatting failed: ' + response.data.result + '</div>';
                                }
                                profileDisplay.innerHTML = parsedResponse;
                                profileDisplay.style.display = 'block';
                                initJudgeRadarChart(); // Re-init chart
                            } catch (error) {
                                console.error('Judge analysis error:', error);
                                document.getElementById('judge-results').innerHTML = `<div class="alert alert-danger">Analysis failed: ${error.response?.data?.detail || error.message}</div>`;
                            } finally {
                                judgeSubmit.disabled = false;
                            }
                        } else {
                            judgeSubmit.disabled = false;
                        }
                    });
                }
                // Smart drafting submit
                const draftingSubmit = document.getElementById('drafting-submit');
                if (draftingSubmit) {
                    draftingSubmit.addEventListener('click', async () => {
                        draftingSubmit.disabled = true;
                        const type = document.getElementById('drafting-type').value;
                        const details = document.getElementById('drafting-details').value.trim();
                        if (details) {
                            try {
                                const response = await axios.post(`${API_BASE_URL}/api/v1/ai/ai-query`, { prompt: `Draft a ${type} with details: ${details}` });
                                document.getElementById('draft-text').value = response.data.result;
                                document.getElementById('drafting-output').style.display = 'block';
                            } catch (error) {
                                console.error('Drafting error:', error);
                                document.getElementById('drafting-results').innerHTML = `<div class="alert alert-danger">Drafting failed: ${error.response?.data?.detail || error.message}</div>`;
                            } finally {
                                draftingSubmit.disabled = false;
                            }
                        } else {
                            draftingSubmit.disabled = false;
                        }
                    });
                }
                // Contract analysis submit (support file or text)
                const contractSubmit = document.getElementById('contract-submit');
                if (contractSubmit) {
                    contractSubmit.addEventListener('click', async (e) => {
                        e.preventDefault();
                        contractSubmit.disabled = true;
                        const files = document.getElementById('contract-file').files;
                        const text = document.getElementById('contract-text').value.trim();
                        const analysisType = document.getElementById('contract-analysis-type').value;
                        const formData = new FormData();
                        formData.append('analysis_type', analysisType);
                        formData.append('text', text);
                        let hasContent = false;
                        for (let file of files) {
                            formData.append('files', file);
                            hasContent = true;
                        }
                        if (text) hasContent = true;
                        if (!hasContent) {
                            showNotification('Please upload files or paste text');
                            contractSubmit.disabled = false;
                            return;
                        }
                        try {
                            const response = await axios.post(`${API_BASE_URL}/api/v1/contract/analyze`, formData, {
                                headers: { 'Content-Type': 'multipart/form-data' }
                            });
                            const outputDisplay = document.getElementById('contract-output');
                            let parsedResponse;
                            try {
                                parsedResponse = marked.parse(response.data.result);
                            } catch (parseError) {
                                console.error('Markdown parse error:', parseError);
                                parsedResponse = '<div class="alert alert-warning">Analysis complete but formatting failed: ' + response.data.result + '</div>';
                            }
                            outputDisplay.innerHTML = parsedResponse;
                            outputDisplay.style.display = 'block';
                            initContractRiskChart(); // Re-init chart
                        } catch (error) {
                            console.error('Contract analysis error:', error);
                            document.getElementById('contract-results').innerHTML = `<div class="alert alert-danger">Analysis failed: ${error.response?.data?.detail || error.message}</div>`;
                        } finally {
                            contractSubmit.disabled = false;
                        }
                    });
                }
                // Citation tracker submit
                const citationSubmit = document.getElementById('citation-submit');
                if (citationSubmit) {
                    citationSubmit.addEventListener('click', async () => {
                        citationSubmit.disabled = true;
                        const citation = document.getElementById('citation-input').value.trim();
                        if (citation) {
                            try {
                                const response = await axios.post(`${API_BASE_URL}/api/v1/ai/ai-query`, { prompt: `Track citation: ${citation}` });
                                document.getElementById('citation-results').innerHTML = `<div class="alert alert-info">${marked.parse(response.data.result)}</div>`;
                            } catch (error) {
                                console.error('Citation tracking error:', error);
                                document.getElementById('citation-results').innerHTML = `<div class="alert alert-danger">Tracking failed: ${error.response?.data?.detail || error.message}</div>`;
                            } finally {
                                citationSubmit.disabled = false;
                            }
                        } else {
                            citationSubmit.disabled = false;
                        }
                    });
                }
                // Privilege scanner submit (support file or text)
                const privilegeSubmit = document.getElementById('privilege-submit');
                if (privilegeSubmit) {
                    privilegeSubmit.addEventListener('click', async (e) => {
                        e.preventDefault();
                        privilegeSubmit.disabled = true;
                        const files = document.getElementById('privilege-file').files;
                        const text = document.getElementById('privilege-text').value.trim();
                        const sensitivity = document.getElementById('privilege-sensitivity').value;
                        const types = Array.from(document.getElementById('privilege-types').selectedOptions).map(opt => opt.value);
                        const formData = new FormData();
                        formData.append('sensitivity', sensitivity);
                        formData.append('types', types.join(','));
                        formData.append('text', text);
                        let hasContent = false;
                        for (let file of files) {
                            formData.append('files', file);
                            hasContent = true;
                        }
                        if (text) hasContent = true;
                        if (!hasContent) {
                            showNotification('Please upload files or paste text');
                            privilegeSubmit.disabled = false;
                            return;
                        }
                        try {
                            const response = await axios.post(`${API_BASE_URL}/api/v1/privilege/scan`, formData, {
                                headers: { 'Content-Type': 'multipart/form-data' }
                            });
                            const resultsDisplay = document.getElementById('privilege-results');
                            let parsedResponse;
                            try {
                                parsedResponse = marked.parse(response.data.result);
                            } catch (parseError) {
                                console.error('Markdown parse error:', parseError);
                                parsedResponse = '<div class="alert alert-warning">Scan complete but formatting failed: ' + response.data.result + '</div>';
                            }
                            resultsDisplay.innerHTML = parsedResponse;
                            initPrivilegeChart(); // Re-init chart
                        } catch (error) {
                            console.error('Privilege scan error:', error);
                            document.getElementById('privilege-results').innerHTML = `<div class="alert alert-danger">Scan failed: ${error.response?.data?.detail || error.message}</div>`;
                        } finally {
                            privilegeSubmit.disabled = false;
                        }
                    });
                }
                // Evidence vault submit (support file or text)
                const evidenceSubmit = document.getElementById('evidence-submit');
                if (evidenceSubmit) {
                    evidenceSubmit.addEventListener('click', async (e) => {
                        e.preventDefault();
                        evidenceSubmit.disabled = true;
                        const files = document.getElementById('evidence-file').files;
                        const description = document.getElementById('evidence-description').value.trim();
                        const evidence_type = document.getElementById('evidence-type').value;
                        const associated_case = document.getElementById('evidence-case').value;
                        const formData = new FormData();
                        formData.append('description', description);
                        formData.append('evidence_type', evidence_type);
                        formData.append('associated_case', associated_case);
                        let hasContent = false;
                        for (let file of files) {
                            formData.append('files', file);
                            hasContent = true;
                        }
                        if (description) hasContent = true;
                        if (!hasContent) {
                            showNotification('Please upload files or provide description/text');
                            evidenceSubmit.disabled = false;
                            return;
                        }
                        try {
                            const response = await axios.post(`${API_BASE_URL}/api/v1/evidence-vault/store-evidence`, formData, {
                                headers: { 'Content-Type': 'multipart/form-data' }
                            });
                            showNotification(`Evidence added: ${response.data.evidence_result}`);
                            fetchEvidenceInventory(); // Refresh inventory
                        } catch (error) {
                            console.error('Evidence upload error:', error);
                            showNotification('Evidence upload failed: ' + (error.response?.data?.detail || error.message));
                        } finally {
                            evidenceSubmit.disabled = false;
                        }
                    });
                }
                // New handlers for analytics section buttons (placeholders)
                const refreshUsage = document.getElementById('refresh-usage');
                if (refreshUsage) {
                    refreshUsage.addEventListener('click', async () => {
                        refreshUsage.disabled = true;
                        await fetchDetailedAnalytics();
                        initUsageChart(); // Re-init
                        refreshUsage.disabled = false;
                    });
                }
                const submitFeedback = document.getElementById('submit-feedback');
                if (submitFeedback) {
                    submitFeedback.addEventListener('click', async () => {
                        submitFeedback.disabled = true;
                        showNotification('Feedback form opening...');
                        // Future: Open feedback modal
                        submitFeedback.disabled = false;
                    });
                }
                const exportReport = document.getElementById('export-report');
                if (exportReport) {
                    exportReport.addEventListener('click', async () => {
                        exportReport.disabled = true;
                        showNotification('Exporting report...');
                        // Future: Generate and download PDF/CSV
                        exportReport.disabled = false;
                    });
                }
                // Initialize Charts Functions
                function initJudgeRadarChart() {
                    const ctx = document.getElementById('judge-radar-chart')?.getContext('2d');
                    if (ctx) {
                        new Chart(ctx, {
                            type: 'radar',
                            data: {
                                labels: ['Leniency', 'Efficiency', 'Reversals', 'Procedural Strictness', 'Oral Arguments'],
                                datasets: [{
                                    label: 'Judge Tendencies',
                                    data: [65, 59, 90, 81, 56],
                                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                    borderColor: 'rgba(59, 130, 246, 1)',
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                scales: {
                                    r: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });
                    }
                }
                function initContractRiskChart() {
                    const ctx = document.getElementById('contract-risk-chart')?.getContext('2d');
                    if (ctx) {
                        new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: ['Low Risk', 'Medium Risk', 'High Risk'],
                                datasets: [{
                                    data: [70, 20, 10],
                                    backgroundColor: ['#10b981', '#f59e0b', '#ef4444']
                                }]
                            },
                            options: {
                                responsive: true,
                                plugins: {
                                    legend: {
                                        position: 'top'
                                    }
                                }
                            }
                        });
                    }
                }
                function initPrivilegeChart() {
                    const ctx = document.getElementById('privilege-chart')?.getContext('2d');
                    if (ctx) {
                        new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: ['Attorney-Client', 'Work Product', 'Trade Secrets', 'Other'],
                                datasets: [{
                                    label: 'Detected Items',
                                    data: [12, 19, 3, 5],
                                    backgroundColor: 'rgba(59, 130, 246, 0.5)'
                                }]
                            },
                            options: {
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });
                    }
                }
                function initEthicsChart() {
                    const ctx = document.getElementById('ethics-chart')?.getContext('2d');
                    if (ctx) {
                        new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'Compliance Score',
                                    data: [92, 94, 95, 96, 97, 98.5],
                                    borderColor: '#10b981',
                                    tension: 0.1
                                }]
                            },
                            options: {
                                responsive: true
                            }
                        });
                    }
                }
                function initUsageChart() {
                    const ctx = document.getElementById('usage-chart')?.getContext('2d');
                    if (ctx) {
                        new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                                datasets: [{
                                    label: 'API Usage',
                                    data: [65, 59, 80, 81, 56, 55, 40],
                                    borderColor: 'rgba(59, 130, 246, 1)',
                                    tension: 0.1
                                }]
                            },
                            options: {
                                responsive: true
                            }
                       });
                    }
                }
                function initFeedbackChart() {
                    const ctx = document.getElementById('feedback-chart')?.getContext('2d');
                    if (ctx) {
                        new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: ['Positive', 'Neutral', 'Negative'],
                                datasets: [{
                                    label: 'Feedback Trends',
                                    data: [85, 10, 5],
                                    backgroundColor: ['#10b981', '#f59e0b', '#ef4444']
                                }]
                            },
                            options: {
                                responsive: true
                            }
                        });
                    }
                }
                // Mobile overlay handler
                const overlay = document.getElementById('overlay');
                if (overlay) {
                    overlay.addEventListener('click', toggleSidebar);
                }
                // Draggable chatbot popup
                let isDragging = false;
                let offsetX, offsetY;
                const chatModal = document.getElementById('ai-query-modal');
                const chatHeader = chatModal.querySelector('.chat-header');
                chatHeader.style.cursor = 'grab';
                chatHeader.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    offsetX = e.clientX - chatModal.getBoundingClientRect().left;
                    offsetY = e.clientY - chatModal.getBoundingClientRect().top;
                    chatModal.style.cursor = 'grabbing';
                });
                document.addEventListener('mousemove', (e) => {
                    if (isDragging) {
                        chatModal.style.left = `${e.clientX - offsetX}px`;
                        chatModal.style.top = `${e.clientY - offsetY}px`;
                        chatModal.style.right = 'auto';
                        chatModal.style.bottom = 'auto';
                    }
                });
                document.addEventListener('mouseup', () => {
                    isDragging = false;
                    chatModal.style.cursor = 'default';
                });
                // Touch support for mobile
                chatHeader.addEventListener('touchstart', (e) => {
                    isDragging = true;
                    offsetX = e.touches[0].clientX - chatModal.getBoundingClientRect().left;
                    offsetY = e.touches[0].clientY - chatModal.getBoundingClientRect().top;
                }, {passive: true});
                document.addEventListener('touchmove', (e) => {
                    if (isDragging) {
                        chatModal.style.left = `${e.touches[0].clientX - offsetX}px`;
                        chatModal.style.top = `${e.touches[0].clientY - offsetY}px`;
                        chatModal.style.right = 'auto';
                        chatModal.style.bottom = 'auto';
                    }
                }, {passive: false});
                document.addEventListener('touchend', () => {
                    isDragging = false;
                });
                // Voice query handler using MediaRecorder
                let isRecording = false;
                let recorder;
                let audioStream;
                let audioChunks = [];
                const voiceButton = document.querySelector('[data-action="voice-query"]');
                if (voiceButton) {
                    voiceButton.addEventListener('click', async () => {
                        if (!('MediaRecorder' in window)) {
                            showNotification('Voice recording not supported in this browser');
                            return;
                        }
                        if (isRecording) {
                            recorder.stop();
                            audioStream.getTracks().forEach(track => track.stop());
                            voiceButton.innerHTML = '<i class="fas fa-microphone"></i> Voice Query';
                            isRecording = false;
                        } else {
                            try {
                                audioStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                                recorder = new MediaRecorder(audioStream);
                                audioChunks = [];
                                recorder.ondataavailable = e => audioChunks.push(e.data);
                                recorder.onstop = async () => {
                                    const blob = new Blob(audioChunks, { type: 'audio/webm' });
                                    const formData = new FormData();
                                    formData.append('audio', blob, 'voice.webm');
                                    try {
                                        const response = await axios.post(`${API_BASE_URL}/api/v1/ai/voice-agent`, formData, {
                                            headers: { 'Content-Type': 'multipart/form-data' }
                                        });
                                        const modal = document.getElementById('ai-query-modal');
                                        modal.classList.add('active');
                                        const chatMessages = document.getElementById('chat-messages');
                                        // Append user message with transcript
                                        const userMsg = document.createElement('div');
                                        userMsg.className = 'chat-message user';
                                        userMsg.innerHTML = `<div class="chat-bubble">${response.data.transcript}</div>`;
                                        chatMessages.appendChild(userMsg);
                                        // Append AI message
                                        const aiMsg = document.createElement('div');
                                        aiMsg.className = 'chat-message ai';
                                        let parsedResponse;
                                        try {
                                            parsedResponse = marked.parse(response.data.result);
                                        } catch (parseError) {
                                            parsedResponse = response.data.result;
                                        }
                                        aiMsg.innerHTML = `<div class="chat-bubble">${parsedResponse}</div>`;
                                        chatMessages.appendChild(aiMsg);
                                        chatMessages.scrollTop = chatMessages.scrollHeight;
                                        fetchMetrics();
                                    } catch (error) {
                                        showNotification('Voice query failed: ' + (error.response?.data?.detail || error.message));
                                    }
                                };
                                recorder.start();
                                voiceButton.innerHTML = '<i class="fas fa-stop"></i> Stop Recording';
                                isRecording = true;
                            } catch (error) {
                                showNotification('Microphone access denied or error: ' + error.message);
                            }
                        }
                    });
                }
            } catch (error) {
                console.error('Initialization error:', error);
                showNotification('Failed to initialize. Please refresh.');
            }
        });
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                document.querySelector('.search-input').focus();
            }
            if (e.key === 'Escape') {
                document.getElementById('sidebar').classList.remove('mobile-open');
                document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('active'));
                document.querySelector('[data-section="dashboard"]').click(); // Back to dashboard on ESC
            }
            if ((e.ctrlKey || e.metaKey) && e.key === 'h') {
                document.querySelector('[data-section="dashboard"]').click(); // Ctrl+H for home
            }
        });
        // Feature card hover effects
        document.querySelectorAll('.feature-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-8px)';
                this.style.boxShadow = 'var(--shadow-xl)';
            });
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = 'var(--shadow-md)';
            });
        });
        // Simulate button loading states
        document.querySelectorAll('.btn-primary').forEach(btn => {
            btn.addEventListener('click', function(e) {
                if (this.textContent.includes('Start Analysis') || this.textContent.includes('Send')) {
                    const originalHtml = this.innerHTML;
                    this.innerHTML = '<div class="loading"></div> Processing...';
                    this.disabled = true;
                    setTimeout(() => {
                        this.innerHTML = originalHtml;
                        this.disabled = false;
                        const alert = document.createElement('div');
                        alert.className = 'alert alert-success';
                        alert.innerHTML = '<i class="fas fa-check-circle me-2"></i>Action completed successfully!';
                        this.parentNode.insertBefore(alert, this);
                        setTimeout(() => alert.remove(), 3000);
                    }, 2000);
                }
            });
        });
   
        // Regulatory submit
        const regulatorySubmit = document.getElementById('regulatory-submit');
        if (regulatorySubmit) {
            regulatorySubmit.addEventListener('click', async () => {
                const jurisdiction = document.getElementById('regulatory-jurisdiction').value;
                const area = document.getElementById('regulatory-area').value;
                try {
                    const response = await axios.post(`${API_BASE_URL}/api/v1/regulatory-radar/monitor`, { jurisdiction, area });
                    document.getElementById('regulatory-results').innerHTML = `<div class="alert alert-info">${JSON.stringify(response.data)}</div>`;
                } catch (error) {
                    document.getElementById('regulatory-results').innerHTML = `<div class="alert alert-danger">Failed: ${error.message}</div>`;
                }
            });
        }
        // Peer submit
        const peerSubmit = document.getElementById('peer-submit');
        if (peerSubmit) {
            peerSubmit.addEventListener('click', async () => {
                const citation = document.getElementById('peer-citation').value;
                try {
                    const response = await axios.post(`${API_BASE_URL}/api/v1/peer-verification/verify`, { citation });
                    document.getElementById('peer-results').innerHTML = `<div class="alert alert-info">${JSON.stringify(response.data)}</div>`;
                } catch (error) {
                    document.getElementById('peer-results').innerHTML = `<div class="alert alert-danger">Failed: ${error.message}</div>`;
                }
            });
        }
        // Calendar handler
        document.querySelectorAll('[data-action="calendar"]').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const modal = document.getElementById('calendar-modal');
                modal.classList.add('active');
                initCalendar();
            });
        });
        async function initCalendar() {
            const calendarEl = document.getElementById('calendar');
            if (calendarEl.innerHTML === '') {
                try {
                    const response = await axios.get(`${API_BASE_URL}/api/v1/calendar/events`);
                    const events = response.data.map(event => ({
                        title: event.title,
                        start: event.start,
                        end: event.end,
                        description: event.description
                    }));
                    const calendar = new FullCalendar.Calendar(calendarEl, {
                        initialView: 'dayGridMonth',
                        headerToolbar: {
                            left: 'prev,next today',
                            center: 'title',
                            right: 'dayGridMonth,timeGridWeek,timeGridDay'
                        },
                        editable: true,
                        events: events,
                        eventClick: function(info) {
                            alert(`Event: ${info.event.title}\nDate: ${info.event.start}\nDescription: ${info.event.extendedProps.description || 'None'}`);
                        }
                    });
                    calendar.render();
                } catch (error) {
                    console.error('Calendar error:', error);
                    showNotification('Failed to load calendar events');
                }
            }
        }
    </script>
</body>
</html>